name: ä¸‹ç­æé†’

on:
  schedule:
    # è°ƒæ•´ä¸º17:45è§¦å‘ï¼ˆUTC 09:45ï¼‰ï¼Œé¢„è®¡17:50-17:55æ”¶åˆ°
    - cron: '45 9 * * 1-5'
    # è°ƒæ•´ä¸º18:05è§¦å‘ï¼ˆUTC 10:05ï¼‰ï¼Œé¢„è®¡18:10-18:15æ”¶åˆ°
    - cron: '05 10 * * 1-5'
  workflow_dispatch:

jobs:
  send-reminder:
    runs-on: ubuntu-latest
    steps:
      - name: å‘é€ä¼å¾®æé†’
        run: |
          # è·å–å½“å‰UTCæ—¶é—´æ¥åˆ¤æ–­æ˜¯å“ªæ¬¡æé†’
          CURRENT_HOUR=$(date -u +%H)
          CURRENT_MINUTE=$(date -u +%M)
          
          if [ "$CURRENT_HOUR" = "09" ] && [ "$CURRENT_MINUTE" = "45" ]; then
            MESSAGE="ğŸ•” ã€é‡è¦æé†’ã€‘å°ä¼™ä¼´ä»¬ï¼Œå†æ¬¡æé†’ï¼æ£€æŸ¥äº‘æ•ˆä»»åŠ¡å…³é—­æƒ…å†µä»¥åŠå·¥æ—¶ç™»è®°ï¼ˆ8å°æ—¶ï¼‰"
          else
            MESSAGE="ğŸ‰ ã€é‡è¦æé†’ã€‘å°ä¼™ä¼´ä»¬ï¼Œå†æ¬¡æé†’ï¼æ£€æŸ¥äº‘æ•ˆä»»åŠ¡å…³é—­æƒ…å†µä»¥åŠå·¥æ—¶ç™»è®°ï¼ˆ8å°æ—¶ï¼‰"
          fi
          
          curl -X POST \
            "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${{ secrets.WEBHOOK_KEY }}" \
            -H "Content-Type: application/json" \
            -d "{
              \"msgtype\": \"text\",
              \"text\": {
                \"content\": \"$MESSAGE\",
                \"mentioned_list\": [\"@all\"]
              }
            }"
