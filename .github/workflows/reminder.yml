name: ä¸‹ç­æé†’

on:
  schedule:
    # ç¬¬ä¸€æ¬¡æé†’ï¼šåŒ—äº¬æ—¶é—´17:50ï¼ˆUTC+8æ˜¯9:50ï¼‰
    - cron: '50 9 * * 1-5'
    # ç¬¬äºŒæ¬¡æé†’ï¼šåŒ—äº¬æ—¶é—´18:10ï¼ˆUTC+8æ˜¯10:10ï¼‰
    - cron: '10 10 * * 1-5'
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘æµ‹è¯•

jobs:
  send-reminder:
    runs-on: ubuntu-latest
    steps:
      - name: å‘é€ä¼å¾®æé†’
        run: |
          # è·å–å½“å‰UTCæ—¶é—´ï¼Œç”¨äºåˆ¤æ–­æ˜¯ç¬¬ä¸€æ¬¡è¿˜æ˜¯ç¬¬äºŒæ¬¡æé†’
          CURRENT_HOUR=$(date -u +%H)
          CURRENT_MINUTE=$(date -u +%M)
          
          if [ "$CURRENT_HOUR" = "09" ] && [ "$CURRENT_MINUTE" = "50" ]; then
            MESSAGE="ğŸ•” ã€ç¬¬ä¸€æ¬¡æé†’ã€‘å°ä¼™ä¼´ä»¬ï¼Œè¿˜æœ‰10åˆ†é’Ÿä¸‹ç­ï¼å…‰é€Ÿæ•´ç†äº‘æ•ˆä»»åŠ¡ï¼~"
          else
            MESSAGE="ğŸ‰ ã€ç¬¬äºŒæ¬¡æé†’ã€‘ä¸‹ç­å•¦ï¼å†æ£€æŸ¥ä¸€éäº‘æ•ˆä»»åŠ¡ï¼~"
          fi
          
          curl -X POST \
            "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${{ secrets.WEBHOOK_KEY }}" \
            -H "Content-Type: application/json" \
            -d "{
              \"msgtype\": \"text\",
              \"text\": {
                \"content\": \"$MESSAGE\",
                \"mentioned_list\": [\"@all\"]
              }
            }"
